

<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="X-UA-Compatible" content="IE=edge">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@JinaAI_">
<meta name="twitter:creator" content="@JinaAI_">
<meta name="description"
      content="Jina is the cloud-native neural search solution powered by the state-of-the-art AI and deep learning">
<meta property="og:title" content="Jina Documentation">
<meta property="og:description"
      content="Jina is the cloud-native neural search solution powered by the state-of-the-art AI and deep learning">
<meta property="og:url" content="https://opensource.jina.ai">
<meta property="og:image" content="../../_static/banner.png">
<meta property="og:type" content="website">
<link rel="icon" href="../../_static/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <title>Tutorial 1 &mdash; Jina 2.0.0rc5 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/main.css" type="text/css" />


  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" /> 
</head>

<body class="wy-body-for-nav">
  <div id="showhide-navbar-btn" onclick="showhide_navbar();"></div>

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="https://docs.jina.ai">
          

          
            
            <img src="../../_static/jina-prod-logo.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            

          <div class="dropdown version">
            <button class="dropbtn version">2.0.0rc5</button>
            <div class="dropdown-content">
              
              <a class="dropdown-item" href="/master">master</a>
              
              <a class="dropdown-item" href="/v1.3.0">1.3.0</a>
              
              <a class="dropdown-item" href="/v1.2.4">1.2.4</a>
              
              <a class="dropdown-item" href="/v1.2.2">1.2.2</a>
              
              <a class="dropdown-item" href="/v1.2.1">1.2.1</a>
              
              <a class="dropdown-item" href="/v1.1.9">1.1.9</a>
              
              <a class="dropdown-item" href="/v1.1.8">1.1.8</a>
              
              <a class="dropdown-item" href="/v1.1.7">1.1.7</a>
              
              <a class="dropdown-item" href="/v1.1.6">1.1.6</a>
              
              <a class="dropdown-item" href="/v1.1.5">1.1.5</a>
              
              <a class="dropdown-item" href="/v1.1.4">1.1.4</a>
              
              <a class="dropdown-item" href="/v1.1.3">1.1.3</a>
              
              <a class="dropdown-item" href="/v1.1.2">1.1.2</a>
              
              <a class="dropdown-item" href="/v1.1.1">1.1.1</a>
              
              <a class="dropdown-item" href="/v1.1.0">1.1.0</a>
              
              <a class="dropdown-item" href="/v1.0.9">1.0.9</a>
              
              <a class="dropdown-item" href="/v1.0.7">1.0.7</a>
              
              <a class="dropdown-item" href="/v1.0.6">1.0.6</a>
              
              <a class="dropdown-item" href="/v1.0.5">1.0.5</a>
              
              <a class="dropdown-item" href="/v1.0.4">1.0.4</a>
              
              <a class="dropdown-item" href="/v1.0.3">1.0.3</a>
              
              <a class="dropdown-item" href="/v1.0.2">1.0.2</a>
              
              <a class="dropdown-item" href="/v1.0.1">1.0.1</a>
              
              <a class="dropdown-item" href="/v1.0.0">1.0.0</a>
              
              <a class="dropdown-item" href="/v0.9.8">0.9.8</a>
              
              <a class="dropdown-item" href="/v0.9.7">0.9.7</a>
              
              <a class="dropdown-item" href="/v0.9.6">0.9.6</a>
              
              <a class="dropdown-item" href="/v0.9.5">0.9.5</a>
              
              <a class="dropdown-item" href="/v0.9.4">0.9.4</a>
              
              <a class="dropdown-item" href="/v0.9.34">0.9.34</a>
              
              <a class="dropdown-item" href="/v0.9.33">0.9.33</a>
              
              <a class="dropdown-item" href="/v0.9.3">0.9.3</a>
              
              <a class="dropdown-item" href="/v0.9.28">0.9.28</a>
              
              <a class="dropdown-item" href="/v0.9.23">0.9.23</a>
              
              <a class="dropdown-item" href="/v0.9.22">0.9.22</a>
              
              <a class="dropdown-item" href="/v0.9.21">0.9.21</a>
              
              <a class="dropdown-item" href="/v0.9.20">0.9.20</a>
              
              <a class="dropdown-item" href="/v0.9.19">0.9.19</a>
              
              <a class="dropdown-item" href="/v0.9.18">0.9.18</a>
              
              <a class="dropdown-item" href="/v0.9.17">0.9.17</a>
              
              <a class="dropdown-item" href="/v0.9.16">0.9.16</a>
              
              <a class="dropdown-item" href="/v0.9.15">0.9.15</a>
              
              <a class="dropdown-item" href="/v0.9.14">0.9.14</a>
              
              <a class="dropdown-item" href="/v0.9.13">0.9.13</a>
              
              <a class="dropdown-item" href="/v0.9.12">0.9.12</a>
              
              <a class="dropdown-item" href="/v0.9.11">0.9.11</a>
              
              <a class="dropdown-item" href="/v0.9.10">0.9.10</a>
              
              <a class="dropdown-item" href="/v0.9.9">0.9.9</a>
              
              <a class="dropdown-item" href="/v0.9.8">0.9.8</a>
              
              <a class="dropdown-item" href="/v0.9.7">0.9.7</a>
              
              <a class="dropdown-item" href="/v0.9.6">0.9.6</a>
              
              <a class="dropdown-item" href="/v0.9.5">0.9.5</a>
              
              <a class="dropdown-item" href="/v0.9.3">0.9.3</a>
              
              <a class="dropdown-item" href="/v0.9.2">0.9.2</a>
              
              <a class="dropdown-item" href="/v0.9.1">0.9.1</a>
              
              <a class="dropdown-item" href="/v0.9.0">0.9.0</a>
              
              <a class="dropdown-item" href="/v0.8.22">0.8.22</a>
              
              <a class="dropdown-item" href="/v0.8.21">0.8.21</a>
              
            </div>
          </div>
            
          


          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Jina Core</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../core/introduction/">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/guides/">Developer Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/api_references/">API Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Jina Dashboard</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dashboard/introduction/">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dashboard/guides/">Developer Guides</a></li>
</ul>
<p class="caption"><span class="caption-text">Jina Hub</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hub/introduction/">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hub/guides/">Developer Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hub/api_references/">API Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Jina Box</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../box/introduction/">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../box/guides/">Developer Guides</a></li>
</ul>
<p class="caption"><span class="caption-text">Glossary</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../glossary/">Glossary</a></li>
</ul>
<p class="caption"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING/">Contributing to Jina</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING/#join-us-on-slack">Join Us on Slack!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../RELEASE/">Release &amp; Version Identifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOG/">Change Logs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jep/">Jina Enhancement Proposals (JEP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting/">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/dev/">FAQ for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/user/">FAQ for End-Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docstring/">Docstring Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Indices and Tables</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../all_exec/">List of 123 Executors in Jina</a></li>
<li class="toctree-l1"><a class="reference internal" href="../all_driver/">List of 62 Drivers in Jina</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../">Jina</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation" class="nav-bar-header">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../" class="icon icon-home"></a> &raquo;</li>
        
      <li>Tutorial 1</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  
<div role="search" class="nav-bar-search">
  <form id="rtd-search-form" class="wy-form doc-searchbox" action="../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs (Press / to focus)" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

</div>
<hr/>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tutorial-1">
<h1><a class="toc-backref" href="#id6">Tutorial 1</a><a class="headerlink" href="#tutorial-1" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#tutorial-1" id="id6">Tutorial 1</a></p>
<ul>
<li><p><a class="reference internal" href="#set-up-overview" id="id7">Set-up &amp; overview</a></p></li>
<li><p><a class="reference internal" href="#tutorial" id="id8">Tutorial</a></p>
<ul>
<li><p><a class="reference internal" href="#define-data-and-work-directories" id="id9">Define data and work directories</a></p></li>
<li><p><a class="reference internal" href="#create-a-flow" id="id10">Create a Flow</a></p></li>
<li><p><a class="reference internal" href="#add-elements-to-a-flow" id="id11">Add elements to a Flow</a></p></li>
<li><p><a class="reference internal" href="#create-dummy-executors" id="id12">Create dummy Executors</a></p></li>
<li><p><a class="reference internal" href="#visualize-a-flow" id="id13">Visualize a Flow</a></p></li>
<li><p><a class="reference internal" href="#use-a-flow" id="id14">Use a Flow</a></p></li>
<li><p><a class="reference internal" href="#to-create-a-document" id="id15">To create a Document</a></p></li>
<li><p><a class="reference internal" href="#get-our-data" id="id16">Get our data</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#community" id="id17">Community</a></p></li>
<li><p><a class="reference internal" href="#license" id="id18">License</a></p></li>
</ul>
</li>
</ul>
</div>
<p>We will use the <a class="reference external" href="https://github.com/jina-ai/jina#run-quick-demo">hello world chatbot</a> for this tutorial. You can find the complete code <a class="reference external" href="https://github.com/jina-ai/jina/tree/master/jina/helloworld/chatbot">here</a> and we will go step by step.</p>
<p>At the end of this tutorial, you will have your own chatbot. You will use text as an input and get a text result as output.
For this example, we will use a <a class="reference external" href="https://www.kaggle.com/xhlulu/covidqa">covid dataset</a>.
You will understand how every part of this example works and how you can create new apps with different datasets on your own.</p>
<div class="section" id="set-up-overview">
<h2><a class="toc-backref" href="#id7">Set-up &amp; overview</a><a class="headerlink" href="#set-up-overview" title="Permalink to this headline">¶</a></h2>
<p>We recommend creating a <a class="reference external" href="https://docs.python.org/3/tutorial/venv.html">new python virtual environment</a>, to have a clean install of Jina and prevent dependency clashing.</p>
<p>We can start by installing Jina:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">jina</span>
</pre></div>
</div>
</div></blockquote>
<p>For more information on installing Jina, refer to this <a class="reference external" href="https://docs.jina.ai/chapters/install/os/via-pip">page</a>.</p>
<p>And we need the following dependencies:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">click</span><span class="o">==</span><span class="mf">7.1</span><span class="o">.</span><span class="mi">2</span>
<span class="n">pip</span> <span class="n">install</span> <span class="n">transformers</span><span class="o">==</span><span class="mf">4.1</span><span class="o">.</span><span class="mi">1</span>
<span class="n">pip</span> <span class="n">install</span> <span class="n">torch</span><span class="o">==</span><span class="mf">1.7</span><span class="o">.</span><span class="mi">1</span>
</pre></div>
</div>
</div></blockquote>
<p>Once you have Jina and the dependencies installed, let’s get a broad overview of the process we’ll follow:</p>
<a class="reference internal image-reference" href="../../_images/flow1.png"><img alt="../../_images/flow1.png" src="../../_images/flow1.png" style="width: 600px;" /></a>
<p>You see from this image that you have your data at the beginning of this Flow process, and this can be any data type:</p>
<ul class="simple">
<li><p>Text</p></li>
<li><p>Images</p></li>
<li><p>Audio</p></li>
<li><p>Video</p></li>
<li><p>Or any other type</p></li>
</ul>
<p>In this case, we are using text, but it can be whatever data type you want.</p>
<p>Once we have our data, as usual in machine learning, you’ll probably need to pre-process that data. To keep this as simple as possible for this first tutorial, we won’t need to do any pre-processing. But remember that this is a possibility for another use case.
Once that is ready, we can encode our data into vectors and finally store those vectors, so they are ready for indexing and querying.</p>
</div>
<div class="section" id="tutorial">
<h2><a class="toc-backref" href="#id8">Tutorial</a><a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h2>
<div class="section" id="define-data-and-work-directories">
<h3><a class="toc-backref" href="#id9">Define data and work directories</a><a class="headerlink" href="#define-data-and-work-directories" title="Permalink to this headline">¶</a></h3>
<p>We can start creating an empty folder, I’ll call mine <cite>tutorial</cite> and that’s the name you’ll see through the tutorial but feel free to use whatever you wish.</p>
<p>We will display our results in our browser, so download the <cite>static</cite> folder from <a class="reference external" href="https://github.com/jina-ai/jina/tree/master/jina/helloworld/chatbot/static">here</a>, and paste it into your <cite>tutorial</cite> folder. This is only the CSS and HTML files to render our results. We will use a dataset in a .csv format. I’ll use the <a class="reference external" href="https://www.kaggle.com/xhlulu/covidqa">COVID</a> dataset from Kaggle. You don’t need to download this by hand, we’ll do it later in our app.</p>
</div>
<div class="section" id="create-a-flow">
<h3><a class="toc-backref" href="#id10">Create a Flow</a><a class="headerlink" href="#create-a-flow" title="Permalink to this headline">¶</a></h3>
<p>The very first concept you’ll see in Jina is a <cite>Flow</cite>. You can see <a class="reference external" href="https://github.com/jina-ai/jina/blob/master/.github/2.0/cookbooks/Flow.md">here</a> a more formal introduction of what it is, but for now, think of the <cite>Flow</cite> as a manager in Jina, it takes care of the all the tasks that will run on your application and each <cite>Flow</cite> object will take care of one real-world task.</p>
<p>To create a <cite>Flow</cite> you only need to import it from Jina.
So open your favorite IDE, create a <cite>app.py</cite> file and let’s start writing our code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Flow</span>
<span class="n">flow</span> <span class="o">=</span> <span class="n">Flow</span><span class="p">()</span>
</pre></div>
</div>
<p>But this is an empty <cite>Flow</cite>. Since we want to encode our data and then index it, we need to add elements to it. The only things we add to a <cite>Flow</cite> are <cite>Executors</cite>. We will talk about them more formally later, but think of them as the elements that will do all the data processing you want.</p>
</div>
<div class="section" id="add-elements-to-a-flow">
<h3><a class="toc-backref" href="#id11">Add elements to a Flow</a><a class="headerlink" href="#add-elements-to-a-flow" title="Permalink to this headline">¶</a></h3>
<p>To add elements to your Flow you just need to use the <cite>add</cite> keyword. You can add as many pods as you wish.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Flow</span>

<span class="n">flow</span> <span class="o">=</span> <span class="n">Flow</span><span class="p">()</span><span class="o">.</span><span class="n">add</span><span class="p">()</span><span class="o">.</span><span class="n">add</span><span class="p">()</span>
</pre></div>
</div>
<p>And for our example, we need to add two <cite>Executors</cite>:</p>
<ol class="arabic simple">
<li><p>A transformer (to encode our data)</p></li>
<li><p>An indexer</p></li>
</ol>
<p>So add the following to our code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Flow</span>
<span class="n">flow</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Flow</span><span class="p">()</span>
        <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">uses</span><span class="o">=</span><span class="n">MyTransformer</span><span class="p">)</span>
        <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">uses</span><span class="o">=</span><span class="n">MyIndexer</span><span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>Right now we haven’t defined <cite>MyTransformer</cite> or <cite>MyIndexer</cite>. Let’s create some dummy <cite>Executors</cite> so we can try our app. These will not be our final <cite>Executors</cite> but just something basic to learn first.</p>
</div>
<div class="section" id="create-dummy-executors">
<h3><a class="toc-backref" href="#id12">Create dummy Executors</a><a class="headerlink" href="#create-dummy-executors" title="Permalink to this headline">¶</a></h3>
<p>Now we have a Flow with two <cite>Executors</cite>. Write the following in your code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Jina</span><span class="p">,</span> <span class="n">Executor</span>

<span class="k">class</span> <span class="nc">MyTransformer</span><span class="p">(</span><span class="n">Executor</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;foo is doing cool stuff: </span><span class="si">{</span><span class="n">kwargs</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">MyIndexer</span><span class="p">(</span><span class="n">Executor</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;bar is doing cool stuff: </span><span class="si">{</span><span class="n">kwargs</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We will have more complex <cite>Executors</cite> later. For now our two <cite>Executors</cite> are only printing a line.</p>
<p>It’s been a lot of information so far, so let’s run our app to see what happens.</p>
<a class="reference internal image-reference" href="../../_images/executors_print.png"><img alt="../../_images/executors_print.png" src="../../_images/executors_print.png" style="width: 600px;" /></a>
<p>If you run the code you should see something similar to this. Somewhere in the output, you should see the messages we defined in our Executors, along with their information.</p>
<p>So we have our <cite>Flow</cite> ready with two <cite>Executors</cite>. So far it’s a simple <cite>Flow</cite> but it is still useful to visualize it to make sure it’s what we want.</p>
</div>
<div class="section" id="visualize-a-flow">
<h3><a class="toc-backref" href="#id13">Visualize a Flow</a><a class="headerlink" href="#visualize-a-flow" title="Permalink to this headline">¶</a></h3>
<p>By now, your code should look like this:</p>
<p>If you want to visualize your Flow you can do that with <cite>plot</cite>. So add the <cite>.plot</cite> function at the end of your <cite>Flow</cite></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Flow</span>

<span class="n">flow</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Flow</span><span class="p">()</span>
        <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">uses</span><span class="o">=</span><span class="n">MyTransformer</span><span class="p">)</span>
        <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">uses</span><span class="o">=</span><span class="n">MyIndexer</span><span class="p">)</span>
        <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;our_flow.svg&#39;</span><span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>Let’s run the code we have so far. If you try it, not much will happen since we are not indexing anything yet, but you will see the new file <cite>our_flow.svg</cite> created on your working folder, and if you open it you would see this:</p>
<a class="reference internal image-reference" href="../../_images/plot_flow1.png"><img alt="../../_images/plot_flow1.png" src="../../_images/plot_flow1.png" style="width: 600px;" /></a>
<p>You can see a <cite>Flow</cite> with two <cite>Executors</cite>, but what if you have many <cite>Executors</cite>? this can quickly become very messy, so it is better to name the <cite>Executors</cite> with <cite>name=’CoolName</cite>. So in our example, we use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Flow</span>

<span class="n">flow</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Flow</span><span class="p">()</span>
        <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;MyTransformer&#39;</span><span class="p">,</span> <span class="n">uses</span><span class="o">=</span><span class="n">MyTransformer</span><span class="p">)</span>
        <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;MyIndexer&#39;</span><span class="p">,</span> <span class="n">uses</span><span class="o">=</span><span class="n">MyIndexer</span><span class="p">)</span>
        <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;our_flow.svg&#39;</span><span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>Now if you run this, you should have a <cite>Flow</cite> that is more explicit:</p>
<a class="reference internal image-reference" href="../../_images/plot_flow2.png"><img alt="../../_images/plot_flow2.png" src="../../_images/plot_flow2.png" style="width: 600px;" /></a>
</div>
<div class="section" id="use-a-flow">
<h3><a class="toc-backref" href="#id14">Use a Flow</a><a class="headerlink" href="#use-a-flow" title="Permalink to this headline">¶</a></h3>
<p>Ok, we have our <cite>Flow</cite> created and visualized. Let’s put it to use now. The correct way to use a <cite>Flow</cite> is to open it as a context manager, using the <cite>with</cite> keyword:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">flow</span><span class="p">:</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>Before we use it in our example, let’s recap a bit of what we have seen:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Flow</span>
<span class="n">flow</span> <span class="o">=</span> <span class="n">Flow</span><span class="p">()</span>          <span class="c1"># Create Flow</span>

<span class="n">flow</span><span class="o">.</span><span class="n">add</span><span class="p">()</span><span class="o">.</span><span class="n">add</span><span class="p">()</span>       <span class="c1"># Add elements to Flow</span>
<span class="n">flow</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>            <span class="c1"># Visualize a Flow</span>

<span class="k">with</span> <span class="n">flow</span><span class="p">:</span>             <span class="c1"># Use Flow as a context manager</span>
    <span class="n">flow</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>
</pre></div>
</div>
<p>In our example, we have a <cite>Flow</cite> with two <cite>Executors</cite> (<cite>MyTransformer</cite> and <cite>MyIndexer</cite>) and we want to use our <cite>Flow</cite> to index our data. But in this case, our data is a <cite>csv</cite> file. We need to open it first.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">flow</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;our_dataset.csv&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">flow</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>
</pre></div>
</div>
<p>Now we have our <cite>Flow</cite> ready, we can start to index. But we can’t just pass the dataset in the original format to our <cite>Flow</cite>. We need to create a <cite>Document</cite> with the data we want to use.</p>
</div>
<div class="section" id="to-create-a-document">
<h3><a class="toc-backref" href="#id15">To create a Document</a><a class="headerlink" href="#to-create-a-document" title="Permalink to this headline">¶</a></h3>
<p>To create a <cite>Document</cite> in Jina, we do it like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Document</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="s1">&#39;hello, world!&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In our case, the content of our Document needs to be the dataset we want to use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Document</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">Document</span><span class="o">.</span><span class="n">from_csv</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">field_resolver</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;question&#39;</span><span class="p">:</span> <span class="s1">&#39;text&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>So what happened there? We created a Document <cite>doc</cite>, and we use <cite>from_csv</cite> to load our dataset.
We use <cite>field_resolver</cite> to map the text from our dataset to the Document attributes.</p>
</div>
<div class="section" id="get-our-data">
<h3><a class="toc-backref" href="#id16">Get our data</a><a class="headerlink" href="#get-our-data" title="Permalink to this headline">¶</a></h3>
<p>We have everything ready to use our <cite>Flow</cite>, but so far we have been using dummy data. Let’s download our dataset now. Copy and paste this snippet, we don’t need to go into the details for this. What it does is to download the <a class="reference external" href="https://www.kaggle.com/xhlulu/covidqa">covid dataset</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">download_data</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">download_proxy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s1">&#39;download covid-dataset&#39;</span><span class="p">):</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Download data.</span>

<span class="sd">:param targets: target path for data.</span>
<span class="sd">:param download_proxy: download proxy (e.g. &#39;http&#39;, &#39;https&#39;)</span>
<span class="sd">:param task_name: name of the task</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">opener</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">build_opener</span><span class="p">()</span>
<span class="n">opener</span><span class="o">.</span><span class="n">addheaders</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;User-agent&#39;</span><span class="p">,</span> <span class="s1">&#39;Mozilla/5.0&#39;</span><span class="p">)]</span>
<span class="k">if</span> <span class="n">download_proxy</span><span class="p">:</span>
    <span class="n">proxy</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">ProxyHandler</span><span class="p">(</span>
        <span class="p">{</span><span class="s1">&#39;http&#39;</span><span class="p">:</span> <span class="n">download_proxy</span><span class="p">,</span> <span class="s1">&#39;https&#39;</span><span class="p">:</span> <span class="n">download_proxy</span><span class="p">}</span>
    <span class="p">)</span>
    <span class="n">opener</span><span class="o">.</span><span class="n">add_handler</span><span class="p">(</span><span class="n">proxy</span><span class="p">)</span>
<span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">install_opener</span><span class="p">(</span><span class="n">opener</span><span class="p">)</span>
<span class="k">with</span> <span class="n">ProgressBar</span><span class="p">(</span><span class="n">task_name</span><span class="o">=</span><span class="n">task_name</span><span class="p">,</span> <span class="n">batch_unit</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">t</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">targets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]):</span>
            <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span>
                <span class="n">value</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">],</span> <span class="n">value</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">],</span> <span class="n">reporthook</span><span class="o">=</span><span class="k">lambda</span> <span class="o">*</span><span class="n">x</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">update_tick</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
            <span class="p">)</span>
</pre></div>
</div>
<p>Let’s re-organize our code a little bit. First, we should import everything we need:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="kn">import</span> <span class="nn">webbrowser</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Flow</span><span class="p">,</span> <span class="n">Executor</span>
<span class="kn">from</span> <span class="nn">jina.logging</span> <span class="kn">import</span> <span class="n">default_logger</span>
<span class="kn">from</span> <span class="nn">jina.logging.profile</span> <span class="kn">import</span> <span class="n">ProgressBar</span>
<span class="kn">from</span> <span class="nn">jina.parsers.helloworld</span> <span class="kn">import</span> <span class="n">set_hw_chatbot_parser</span>
<span class="kn">from</span> <span class="nn">jina.types.document.generators</span> <span class="kn">import</span> <span class="n">from_csv</span>
</pre></div>
</div>
<p>Then we should have our <cite>main</cite>, a <cite>download_data</cite> function to get our data and a <cite>tutorial</cite> function for all the rest</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">download_data</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">download_proxy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s1">&#39;download covid-dataset&#39;</span><span class="p">):</span>
    <span class="c1"># This is exactly as the previous snippet we just saw</span>

<span class="k">def</span> <span class="nf">tutorial</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="c1"># Here we will have everything for our tutorial</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">set_hw_chatbot_parser</span><span class="p">()</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="n">tutorial</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</pre></div>
</div>
<p>Now let’s see our <cite>tutorial</cite> function with all the code we’ve done so far:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">tutorial</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="n">Path</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">workdir</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">MyTransformer</span><span class="p">(</span><span class="n">Executor</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;foo is doing cool stuff: </span><span class="si">{</span><span class="n">kwargs</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">MyIndexer</span><span class="p">(</span><span class="n">Executor</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;bar is doing cool stuff: </span><span class="si">{</span><span class="n">kwargs</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">targets</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;covid-csv&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="n">args</span><span class="o">.</span><span class="n">index_data_url</span><span class="p">,</span>
            <span class="s1">&#39;filename&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">workdir</span><span class="p">,</span> <span class="s1">&#39;dataset.csv&#39;</span><span class="p">),</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1"># download the data</span>
    <span class="n">download_data</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">download_proxy</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s1">&#39;download covid-dataset&#39;</span><span class="p">)</span>

    <span class="n">flow</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Flow</span><span class="p">()</span>
            <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;MyTransformer&#39;</span><span class="p">,</span> <span class="n">uses</span><span class="o">=</span><span class="n">MyTransformer</span><span class="p">)</span>
            <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;MyIndexer&#39;</span><span class="p">,</span> <span class="n">uses</span><span class="o">=</span><span class="n">MyIndexer</span><span class="p">)</span>
            <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;test.svg&#39;</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">with</span> <span class="n">flow</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">targets</span><span class="p">[</span><span class="s1">&#39;covid-csv&#39;</span><span class="p">][</span><span class="s1">&#39;filename&#39;</span><span class="p">])</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">flow</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">from_csv</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">field_resolver</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;question&#39;</span><span class="p">:</span> <span class="s1">&#39;text&#39;</span><span class="p">}))</span>
</pre></div>
</div>
<p>If you run this, it should finish without errors. You won’t see much yet because we are not showing anything after we index. But you should see a new directory created with the downloaded dataset:</p>
<a class="reference internal image-reference" href="../../_images/downloaded_dataset.png"><img alt="../../_images/downloaded_dataset.png" src="../../_images/downloaded_dataset.png" style="width: 600px;" /></a>
<p>To actually see something we need to specify how we will display it. For our tutorial we will do so in our browser. Add the following after indexing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">flow</span><span class="o">.</span><span class="n">use_rest_gateway</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">port_expose</span><span class="p">)</span>

<span class="n">url_html_path</span> <span class="o">=</span> <span class="s1">&#39;file://&#39;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)),</span> <span class="s1">&#39;static/index.html&#39;</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url_html_path</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>  <span class="c1"># intentional pass, browser support isn&#39;t cross-platform</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">default_logger</span><span class="o">.</span><span class="n">success</span><span class="p">(</span>
        <span class="sa">f</span><span class="s1">&#39;You should see a demo page opened in your browser, &#39;</span>
        <span class="sa">f</span><span class="s1">&#39;if not, you may open </span><span class="si">{</span><span class="n">url_html_path</span><span class="si">}</span><span class="s1"> manually&#39;</span>
    <span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">unblock_query_flow</span><span class="p">:</span>
    <span class="n">flow</span><span class="o">.</span><span class="n">block</span><span class="p">()</span>
</pre></div>
</div>
<p>For more information on what the Flow is doing, specially in <cite>f.use_rest_gateway(args.port_expose)</cite> and <cite>f.block()</cite> check our <a class="reference external" href="https://github.com/jina-ai/jina/blob/master/.github/2.0/cookbooks/Flow.md">cookbook</a></p>
<p>Ok, so it seems that we have plenty of work done already. If you run this you will see a new tab open in your browser, and there you will have a text box ready for you to input some text. However, if you try to enter anything you won’t get any results. This is because we are using dummy Executors. Our <cite>MyTransformer</cite> and <cite>MyIndexer</cite> aren’t actually doing anything. So far they only print a line when they are called. So we need real <cite>Executors</cite>.</p>
<p>This has been plenty of new information you’ve learned so far, so we won’t go deep into <cite>Executors</cite> today. Instead you can copy-paste the ones we are using for <a class="reference external" href="https://github.com/jina-ai/jina/blob/master/jina/helloworld/chatbot/executors.py">this example</a>, save that <cite>executors.py</cite> file in the same directory where the rest of your code is. The important part to understand is that all Executors’ behavior is defined in <cite>executors.py</cite></p>
<p>To try the <cite>Executors</cite> from the Github repo, just add this before the <cite>download_data</cite> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">executors</span> <span class="kn">import</span> <span class="n">MyTransformer</span><span class="p">,</span> <span class="n">MyIndexer</span>
<span class="k">else</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">.executors</span> <span class="kn">import</span> <span class="n">MyTransformer</span><span class="p">,</span> <span class="n">MyIndexer</span>
</pre></div>
</div>
<p>And remove the dummy executors we made. Your <cite>app.py</cite> should now look like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="kn">import</span> <span class="nn">webbrowser</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Flow</span><span class="p">,</span> <span class="n">Executor</span>
<span class="kn">from</span> <span class="nn">jina.logging</span> <span class="kn">import</span> <span class="n">default_logger</span>
<span class="kn">from</span> <span class="nn">jina.logging.profile</span> <span class="kn">import</span> <span class="n">ProgressBar</span>
<span class="kn">from</span> <span class="nn">jina.parsers.helloworld</span> <span class="kn">import</span> <span class="n">set_hw_chatbot_parser</span>
<span class="kn">from</span> <span class="nn">jina.types.document.generators</span> <span class="kn">import</span> <span class="n">from_csv</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">executors</span> <span class="kn">import</span> <span class="n">MyTransformer</span><span class="p">,</span> <span class="n">MyIndexer</span>
<span class="k">else</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">.executors</span> <span class="kn">import</span> <span class="n">MyTransformer</span><span class="p">,</span> <span class="n">MyIndexer</span>


<span class="k">def</span> <span class="nf">download_data</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">download_proxy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s1">&#39;download fashion-mnist&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Download data.</span>

<span class="sd">    :param targets: target path for data.</span>
<span class="sd">    :param download_proxy: download proxy (e.g. &#39;http&#39;, &#39;https&#39;)</span>
<span class="sd">    :param task_name: name of the task</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">opener</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">build_opener</span><span class="p">()</span>
    <span class="n">opener</span><span class="o">.</span><span class="n">addheaders</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;User-agent&#39;</span><span class="p">,</span> <span class="s1">&#39;Mozilla/5.0&#39;</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">download_proxy</span><span class="p">:</span>
        <span class="n">proxy</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">ProxyHandler</span><span class="p">(</span>
            <span class="p">{</span><span class="s1">&#39;http&#39;</span><span class="p">:</span> <span class="n">download_proxy</span><span class="p">,</span> <span class="s1">&#39;https&#39;</span><span class="p">:</span> <span class="n">download_proxy</span><span class="p">}</span>
        <span class="p">)</span>
        <span class="n">opener</span><span class="o">.</span><span class="n">add_handler</span><span class="p">(</span><span class="n">proxy</span><span class="p">)</span>
    <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">install_opener</span><span class="p">(</span><span class="n">opener</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">ProgressBar</span><span class="p">(</span><span class="n">task_name</span><span class="o">=</span><span class="n">task_name</span><span class="p">,</span> <span class="n">batch_unit</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">t</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">targets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]):</span>
                <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span>
                    <span class="n">v</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">],</span> <span class="n">reporthook</span><span class="o">=</span><span class="k">lambda</span> <span class="o">*</span><span class="n">x</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">update_tick</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
                <span class="p">)</span>

<span class="k">def</span> <span class="nf">tutorial</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>

    <span class="n">Path</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">workdir</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Comment this to use the exectors you have in `executors.py`</span>
<span class="sd">    class MyTransformer(Executor):</span>
<span class="sd">        def foo(self, **kwargs):</span>
<span class="sd">            print(f&#39;foo is doing cool stuff: {kwargs}&#39;)</span>

<span class="sd">    class MyIndexer(Executor):</span>
<span class="sd">        def bar(self, **kwargs):</span>
<span class="sd">            print(f&#39;bar is doing cool stuff: {kwargs}&#39;)</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">targets</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;covid-csv&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="n">args</span><span class="o">.</span><span class="n">index_data_url</span><span class="p">,</span>
            <span class="s1">&#39;filename&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">workdir</span><span class="p">,</span> <span class="s1">&#39;dataset.csv&#39;</span><span class="p">),</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1"># download the data</span>
    <span class="n">download_data</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">download_proxy</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s1">&#39;download covid-dataset&#39;</span><span class="p">)</span>

    <span class="n">f</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Flow</span><span class="p">()</span>
            <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;MyTransformer&#39;</span><span class="p">,</span> <span class="n">uses</span><span class="o">=</span><span class="n">MyTransformer</span><span class="p">)</span>
            <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;MyIndexer&#39;</span><span class="p">,</span> <span class="n">uses</span><span class="o">=</span><span class="n">MyIndexer</span><span class="p">)</span>
            <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;test.svg&#39;</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">with</span> <span class="n">f</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">targets</span><span class="p">[</span><span class="s1">&#39;covid-csv&#39;</span><span class="p">][</span><span class="s1">&#39;filename&#39;</span><span class="p">])</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">from_csv</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">field_resolver</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;question&#39;</span><span class="p">:</span> <span class="s1">&#39;text&#39;</span><span class="p">}))</span>

        <span class="c1"># switch to REST gateway at runtime</span>
        <span class="n">f</span><span class="o">.</span><span class="n">use_rest_gateway</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">port_expose</span><span class="p">)</span>

        <span class="n">url_html_path</span> <span class="o">=</span> <span class="s1">&#39;file://&#39;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)),</span> <span class="s1">&#39;static/index.html&#39;</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url_html_path</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>  <span class="c1"># intentional pass, browser support isn&#39;t cross-platform</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">default_logger</span><span class="o">.</span><span class="n">success</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;You should see a demo page opened in your browser, &#39;</span>
                <span class="sa">f</span><span class="s1">&#39;if not, you may open </span><span class="si">{</span><span class="n">url_html_path</span><span class="si">}</span><span class="s1"> manually&#39;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span><span class="o">.</span><span class="n">unblock_query_flow</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">block</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">set_hw_chatbot_parser</span><span class="p">()</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="n">tutorial</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</pre></div>
</div>
<p>And your directory should be:</p>
<dl>
<dt>::</dt><dd><div class="line-block">
<div class="line">project</div>
<div class="line">├── app.py</div>
<div class="line">├── executors.py</div>
<div class="line">├── static/</div>
<div class="line">├── our_flow.svg #This will be here if you used the <cite>.plot()</cite> function</div>
</div>
</dd>
</dl>
<p>And we are done! If you followed all the steps, now you should have something like this in your browser:</p>
<a class="reference internal image-reference" href="../../_images/results.png"><img alt="../../_images/results.png" src="../../_images/results.png" style="width: 600px;" /></a>
<p>There are still a lot of concepts to learn. So stay tuned for our next tutorials.</p>
<p>If you have any issues following this tutorial, you can always get support from our <a class="reference external" href="https://slack.jina.ai/">Slack community</a></p>
</div>
</div>
<div class="section" id="community">
<h2><a class="toc-backref" href="#id17">Community</a><a class="headerlink" href="#community" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://slack.jina.ai/">Slack community</a> - a communication platform for developers to discuss Jina.</p></li>
<li><p><a class="reference external" href="https://www.linkedin.com/company/jinaai/">LinkedIn</a> - get to know Jina AI as a company and find job opportunities.</p></li>
<li><p><a class="reference external" href="https://twitter.com/JinaAI_">Twitter</a>  - follow us and interact with us using hashtag <cite>#JinaSearch</cite>.</p></li>
<li><p><a class="reference external" href="https://jina.ai">Company</a> - know more about our company, we are fully committed to open-source!</p></li>
</ul>
</div>
<div class="section" id="license">
<h2><a class="toc-backref" href="#id18">License</a><a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h2>
<p>Copyright (c) 2021 Jina AI Limited. All rights reserved.</p>
<p>Jina is licensed under the Apache License, Version 2.0. See <a class="reference external" href="https://github.com/jina-ai/jina/blob/master/LICENSE">LICENSE</a> for the full license text.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    

    <hr/>

    <div role="contentinfo">
        <nav class="devsite-footer-linkboxes nocontent" aria-label="Footer links">

            <ul class="devsite-footer-linkboxes-list">

                <li class="devsite-footer-linkbox ">
                    <h3 class="devsite-footer-linkbox-heading no-link">Stay connected</h3>
                    <ul class="devsite-footer-linkbox-list">

                        <li class="devsite-footer-linkbox-item">

                            <a href="https://github.com/jina-ai/jina" class="devsite-footer-linkbox-link gc-analytics-event"
                               data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">

                                <i class="fab fa-github"></i> GitHub

                            </a>

                        </li>

                        <li class="devsite-footer-linkbox-item">

                            <a href="https://www.linkedin.com/company/jinaai/" class="devsite-footer-linkbox-link gc-analytics-event"
                               data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">

                                <i class="fab fa-linkedin"></i> LinkedIn

                            </a>

                        </li>



                        <li class="devsite-footer-linkbox-item">

                            <a href="https://twitter.com/JinaAI_" class="devsite-footer-linkbox-link gc-analytics-event"
                               data-category="Site-Wide Custom Events" data-label="Footer Link (index 3)">

                                <i class="fab fa-twitter"></i> Twitter

                            </a>

                        </li>

                        <li class="devsite-footer-linkbox-item">

                            <a href="https://www.youtube.com/c/JinaAI" class="devsite-footer-linkbox-link gc-analytics-event"
                               data-category="Site-Wide Custom Events" data-label="Footer Link (index 4)">

                                <i class="fab fa-youtube"></i> YouTube

                            </a>

                        </li>

                    </ul>
                </li>

                <li class="devsite-footer-linkbox ">
                    <h3 class="devsite-footer-linkbox-heading no-link">Support</h3>
                    <ul class="devsite-footer-linkbox-list">
                        <li class="devsite-footer-linkbox-item">

                            <a href="https://slack.jina.ai"
                               class="devsite-footer-linkbox-link gc-analytics-event"
                               data-category="Site-Wide Custom Events" data-label="Footer Link (index 3)">

                                <i class="fab fa-slack"></i> Slack community

                            </a>

                        </li>

                        <li class="devsite-footer-linkbox-item">

                            <a href="https://github.com/jina-ai/jina/issues"
                               class="devsite-footer-linkbox-link gc-analytics-event"
                               data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">

                                Issue tracker

                            </a>

                        </li>

                        <li class="devsite-footer-linkbox-item">

                            <a href="https://github.com/jina-ai/jina/blob/master/CHANGELOG.md"
                               class="devsite-footer-linkbox-link gc-analytics-event"
                               data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">

                                Release notes

                            </a>

                        </li>



                        <li class="devsite-footer-linkbox-item">

                            <a href="https://career.jina.ai"
                               class="devsite-footer-linkbox-link gc-analytics-event"
                               data-category="Site-Wide Custom Events" data-label="Footer Link (index 4)">

                                Career@Jina AI

                            </a>

                        </li>


                    </ul>
                </li>

            </ul>

        </nav>
        <p>
            
            &copy; Copyright Jina AI Limited. All rights reserved.
            <span class="lastupdated">
        Last updated on Jun 10, 2021.
      </span>

        </p>
    </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });

      function showhide_navbar() {
      var x = document.getElementsByClassName("wy-nav-side")[0];
      var y = document.getElementsByClassName("wy-nav-content-wrap")[0];
      var z = document.getElementById("showhide-navbar-btn");
      if (x.style.display === "none") {
        x.style.display = "block";
        y.style.marginLeft = "300px";
        z.style.left = "300px";
      } else {
        x.style.display = "none";
        y.style.marginLeft = "0";
        z.style.left = "0px";
      }
    }

  </script>

  <!-- Search box becomes active when you press the slash(/) key anywhere on the page-->
  <script>
    const body = document.querySelector('body');
    const searchBox = document.querySelector('form').querySelector('input[type="text"]');

    body.addEventListener('keyup', event => {
      event.preventDefault()
      if (event.key === '/') {
        searchBox.focus();
      }
    });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-164627626-3', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>