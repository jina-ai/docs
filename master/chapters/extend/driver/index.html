

<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="utf-8">
  <meta content="Developer Guide: Add new Drivers" name="description" />
<meta content="Jina, driver" name="keywords" />

  <meta name="X-UA-Compatible" content="IE=edge">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@JinaAI_">
<meta name="twitter:creator" content="@JinaAI_">
<meta name="description"
      content="Jina is the cloud-native neural search solution powered by the state-of-the-art AI and deep learning">
<meta property="og:title" content="Jina Documentation">
<meta property="og:description"
      content="Jina is the cloud-native neural search solution powered by the state-of-the-art AI and deep learning">
<meta property="og:url" content="https://opensource.jina.ai">
<meta property="og:image" content="../../../_static/banner.png">
<meta property="og:type" content="website">
<link rel="icon" href="../../../_static/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <title>Adding New Drivers &mdash; Jina 2.0.0rc5 documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/main.css" type="text/css" />


  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/clipboard.min.js"></script>
        <script src="../../../_static/copybutton.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex/" />
    <link rel="search" title="Search" href="../../../search/" />
    <link rel="next" title="Composing a Search Workflow with the Flow API" href="../../flow/" />
    <link rel="prev" title="Peas and Pods" href="../../peas-and-pods/" /> 
</head>

<body class="wy-body-for-nav">
  <div id="showhide-navbar-btn" onclick="showhide_navbar();"></div>

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="https://docs.jina.ai">
          

          
            
            <img src="../../../_static/jina-prod-logo.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            

          <div class="dropdown version">
            <button class="dropbtn version">2.0.0rc5</button>
            <div class="dropdown-content">
              
              <a class="dropdown-item" href="/master">master</a>
              
              <a class="dropdown-item" href="/v1.3.0">1.3.0</a>
              
              <a class="dropdown-item" href="/v1.2.4">1.2.4</a>
              
              <a class="dropdown-item" href="/v1.2.2">1.2.2</a>
              
              <a class="dropdown-item" href="/v1.2.1">1.2.1</a>
              
              <a class="dropdown-item" href="/v1.1.9">1.1.9</a>
              
              <a class="dropdown-item" href="/v1.1.8">1.1.8</a>
              
              <a class="dropdown-item" href="/v1.1.7">1.1.7</a>
              
              <a class="dropdown-item" href="/v1.1.6">1.1.6</a>
              
              <a class="dropdown-item" href="/v1.1.5">1.1.5</a>
              
              <a class="dropdown-item" href="/v1.1.4">1.1.4</a>
              
              <a class="dropdown-item" href="/v1.1.3">1.1.3</a>
              
              <a class="dropdown-item" href="/v1.1.2">1.1.2</a>
              
              <a class="dropdown-item" href="/v1.1.1">1.1.1</a>
              
              <a class="dropdown-item" href="/v1.1.0">1.1.0</a>
              
              <a class="dropdown-item" href="/v1.0.9">1.0.9</a>
              
              <a class="dropdown-item" href="/v1.0.7">1.0.7</a>
              
              <a class="dropdown-item" href="/v1.0.6">1.0.6</a>
              
              <a class="dropdown-item" href="/v1.0.5">1.0.5</a>
              
              <a class="dropdown-item" href="/v1.0.4">1.0.4</a>
              
              <a class="dropdown-item" href="/v1.0.3">1.0.3</a>
              
              <a class="dropdown-item" href="/v1.0.2">1.0.2</a>
              
              <a class="dropdown-item" href="/v1.0.1">1.0.1</a>
              
              <a class="dropdown-item" href="/v1.0.0">1.0.0</a>
              
              <a class="dropdown-item" href="/v0.9.8">0.9.8</a>
              
              <a class="dropdown-item" href="/v0.9.7">0.9.7</a>
              
              <a class="dropdown-item" href="/v0.9.6">0.9.6</a>
              
              <a class="dropdown-item" href="/v0.9.5">0.9.5</a>
              
              <a class="dropdown-item" href="/v0.9.4">0.9.4</a>
              
              <a class="dropdown-item" href="/v0.9.34">0.9.34</a>
              
              <a class="dropdown-item" href="/v0.9.33">0.9.33</a>
              
              <a class="dropdown-item" href="/v0.9.3">0.9.3</a>
              
              <a class="dropdown-item" href="/v0.9.28">0.9.28</a>
              
              <a class="dropdown-item" href="/v0.9.23">0.9.23</a>
              
              <a class="dropdown-item" href="/v0.9.22">0.9.22</a>
              
              <a class="dropdown-item" href="/v0.9.21">0.9.21</a>
              
              <a class="dropdown-item" href="/v0.9.20">0.9.20</a>
              
              <a class="dropdown-item" href="/v0.9.19">0.9.19</a>
              
              <a class="dropdown-item" href="/v0.9.18">0.9.18</a>
              
              <a class="dropdown-item" href="/v0.9.17">0.9.17</a>
              
              <a class="dropdown-item" href="/v0.9.16">0.9.16</a>
              
              <a class="dropdown-item" href="/v0.9.15">0.9.15</a>
              
              <a class="dropdown-item" href="/v0.9.14">0.9.14</a>
              
              <a class="dropdown-item" href="/v0.9.13">0.9.13</a>
              
              <a class="dropdown-item" href="/v0.9.12">0.9.12</a>
              
              <a class="dropdown-item" href="/v0.9.11">0.9.11</a>
              
              <a class="dropdown-item" href="/v0.9.10">0.9.10</a>
              
              <a class="dropdown-item" href="/v0.9.9">0.9.9</a>
              
              <a class="dropdown-item" href="/v0.9.8">0.9.8</a>
              
              <a class="dropdown-item" href="/v0.9.7">0.9.7</a>
              
              <a class="dropdown-item" href="/v0.9.6">0.9.6</a>
              
              <a class="dropdown-item" href="/v0.9.5">0.9.5</a>
              
              <a class="dropdown-item" href="/v0.9.3">0.9.3</a>
              
              <a class="dropdown-item" href="/v0.9.2">0.9.2</a>
              
              <a class="dropdown-item" href="/v0.9.1">0.9.1</a>
              
              <a class="dropdown-item" href="/v0.9.0">0.9.0</a>
              
              <a class="dropdown-item" href="/v0.8.22">0.8.22</a>
              
              <a class="dropdown-item" href="/v0.8.21">0.8.21</a>
              
            </div>
          </div>
            
          


          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Jina Core</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../core/introduction/">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../core/guides/">Developer Guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../core/setup/">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../my_first_jina_app/">Building Your First Jina App</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../install/ide-speedup/">Speeding Up Development in PyCharm and VSCode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../primitive_data_type/">Primitive Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mime-type/">MIME Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../traversal/">Recursive Document Representation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../executors/">Processing Documents with Executors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../simple_exec/">Built-in Simple Executors and Reserved <code class="docutils literal notranslate"><span class="pre">uses</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../executor/">Adding New Executors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../peas-and-pods/">Peas and Pods</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Adding New Drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../flow/">Composing a Search Workflow with the Flow API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../input_output/">Inputs and Outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../crud/">CRUD Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cross_multi_modality/">Multi-modal and Cross-modal Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sparse/">Using Sparse Embeddings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../logging/">Configuring Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cli/exit/">Exiting a Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dump-reload/">Rolling Updates and Query While Indexing in Jina</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../evaluation/">Evaluating a Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../optimization/">Optimizing a Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ranker/">Ranking Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ranker_trainer/">A guide on Jina Ranker Trainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../prevent_duplicate_indexing/">Preventing Duplicate Indexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../incremental_indexing/">Incremental Indexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../parallel/">Parallelization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../batching/">Batching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../request_size/">Request Size</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../remote/">Distributing Jina Remotely</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stress/">Cloud Benchmark &amp; Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../envs/">OS Environment Variables Used in Jina</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../flow/pattern/">Common Design Patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../autocomplete/">Autocomplete commands on Bash, Zsh and Fish</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../core/api_references/">API Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Jina Dashboard</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../dashboard/introduction/">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dashboard/guides/">Developer Guides</a></li>
</ul>
<p class="caption"><span class="caption-text">Jina Hub</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../hub/introduction/">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hub/guides/">Developer Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../hub/api_references/">API Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Jina Box</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../box/introduction/">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../box/guides/">Developer Guides</a></li>
</ul>
<p class="caption"><span class="caption-text">Glossary</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../glossary/">Glossary</a></li>
</ul>
<p class="caption"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../CONTRIBUTING/">Contributing to Jina</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CONTRIBUTING/#join-us-on-slack">Join Us on Slack!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../RELEASE/">Release &amp; Version Identifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG/">Change Logs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../jep/">Jina Enhancement Proposals (JEP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../troubleshooting/">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/dev/">FAQ for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/user/">FAQ for End-Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docstring/">Docstring Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Indices and Tables</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../all_exec/">List of 123 Executors in Jina</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../all_driver/">List of 62 Drivers in Jina</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../">Jina</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation" class="nav-bar-header">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../core/guides/">Developer Guides</a> &raquo;</li>
        
      <li>Adding New Drivers</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  
<div role="search" class="nav-bar-search">
  <form id="rtd-search-form" class="wy-form doc-searchbox" action="../../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs (Press / to focus)" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

</div>
<hr/>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="adding-new-drivers">
<h1><a class="toc-backref" href="#id3">Adding New Drivers</a><a class="headerlink" href="#adding-new-drivers" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This guide assumes you have a basic understanding of Jina. If you haven’t, please check out <a class="reference external" href="https://101.jina.ai">Jina 101</a> first.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an advanced developer guide. The existing Drivers should cover most use cases. If you add custom Drivers, the Jina community may not be able to provide you with development support.</p>
</div>
<div class="contents topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#adding-new-drivers" id="id3">Adding New Drivers</a></p>
<ul>
<li><p><a class="reference internal" href="#motivation" id="id4">Motivation</a></p></li>
<li><p><a class="reference internal" href="#overview" id="id5">Overview</a></p></li>
<li><p><a class="reference internal" href="#implementation" id="id6">Implementation</a></p></li>
<li><p><a class="reference internal" href="#customize-driver-in-action-multimodaldriver" id="id7">Customize Driver in Action: <cite>MultimodalDriver</cite></a></p></li>
<li><p><a class="reference internal" href="#what-s-next" id="id8">What’s next</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="motivation">
<h2><a class="toc-backref" href="#id4">Motivation</a><a class="headerlink" href="#motivation" title="Permalink to this headline">¶</a></h2>
<p>As you might have already learned from <a class="reference external" href="https://101.jina.ai">Jina 101</a>,
a <a class="reference internal" href="../../glossary/#term-Driver"><span class="xref std std-term">Driver</span></a> interprets incoming messages into <a class="reference internal" href="../../glossary/#term-Document"><span class="xref std std-term">Document</span></a> and extracts required fields for an <a class="reference internal" href="../../glossary/#term-Executor"><span class="xref std std-term">Executor</span></a>.</p>
<p>Jina already created <a class="reference external" href="https://docs.jina.ai/chapters/all_driver/">several Drivers</a> inside Core,
and these <cite>Drivers</cite> should already fulfill most of the scenarios.
However, when the existing solutions do not fit your specific use case,
you might be curious how to <strong>extend</strong> Jina.
For instance, if you have created a customized <cite>Executor</cite>,
and figure out the existent <cite>Drivers</cite> can not fit for your customized <cite>Executor</cite>,
you might want to create a customized <cite>Driver</cite>.</p>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id5">Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>There are two steps to adding an extension of a Jina <cite>Driver</cite>:</p>
<ol class="arabic simple">
<li><p>Decide which <cite>Driver</cite> class to inherit from.</p></li>
<li><p>Overwrite the <strong>core</strong> method of the <cite>Driver</cite>.</p></li>
</ol>
</div>
<div class="section" id="implementation">
<h2><a class="toc-backref" href="#id6">Implementation</a><a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h2>
<p>If you want to create a customized <cite>Executor</cite> and its associated <cite>Driver</cite>,
follow the table below to decide which <cite>BaseDriver</cite> class to inherit from.
After creating your customized <cite>Driver</cite> class, you need to implement your own core method based on your specific need.</p>
<table class="colwidths-given docutils align-default" id="id2">
<caption><span class="caption-text">Built-in Driver to Inherit</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 40%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Corresponded Executor</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Core method</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><cite>BaseEncodeDriver</cite></p></td>
<td><p><cite>BaseEncoder</cite></p></td>
<td><p>Driver bind with <code class="xref py py-meth docutils literal notranslate"><span class="pre">encode()</span></code> in the Executor.</p></td>
<td><p><cite>_apply_all</cite></p></td>
</tr>
<tr class="row-odd"><td><p><cite>BaseIndexDriver</cite></p></td>
<td><p><cite>BaseIndexer</cite></p></td>
<td><p>Driver bind with <code class="xref py py-meth docutils literal notranslate"><span class="pre">add()</span></code> in the Executor.</p></td>
<td><p><cite>_apply_all</cite></p></td>
</tr>
<tr class="row-even"><td><p><cite>BaseSearchDriver</cite></p></td>
<td><p><cite>BaseIndexer</cite></p></td>
<td><p>Driver bind with <code class="xref py py-meth docutils literal notranslate"><span class="pre">query()</span></code> in the Executor.</p></td>
<td><p><cite>_apply_all</cite></p></td>
</tr>
<tr class="row-odd"><td><p><cite>BasePredictDriver</cite></p></td>
<td><p><cite>BaseClassifier</cite></p></td>
<td><p>Driver bind with <code class="xref py py-meth docutils literal notranslate"><span class="pre">predict()</span></code> in the Executor.</p></td>
<td><p><cite>_apply_all</cite></p></td>
</tr>
<tr class="row-even"><td><p><cite>BaseLabelPredictDriver</cite></p></td>
<td><p><cite>BaseClassifier</cite></p></td>
<td><p>Driver bind with <code class="xref py py-meth docutils literal notranslate"><span class="pre">predict()</span></code> for label prediction.</p></td>
<td><p><cite>prediction2label</cite></p></td>
</tr>
<tr class="row-odd"><td><p><cite>BaseEvaluateDriver</cite></p></td>
<td><p><cite>BaseEvaluator</cite></p></td>
<td><p>Driver bind with <code class="xref py py-meth docutils literal notranslate"><span class="pre">evaluate()</span></code> in the Executor.</p></td>
<td><p><cite>extract</cite></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="customize-driver-in-action-multimodaldriver">
<h2><a class="toc-backref" href="#id7">Customize Driver in Action: <cite>MultimodalDriver</cite></a><a class="headerlink" href="#customize-driver-in-action-multimodaldriver" title="Permalink to this headline">¶</a></h2>
<p>We created <a class="reference external" href="https://github.com/jina-ai/jina/blob/master/jina/drivers/multimodal.py">MultimodalDriver</a> to better support Cross/Multi-modal search.
Assume a <cite>Document</cite> has 2 child <cite>Documents</cite> with different modalities, e.g. text and image.
The objective of <cite>MultimodalDriver</cite> is to extract embeddings from both modalities.
Our expected input and output can be represented as:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>Input:
document:
        <span class="p">|</span>- child document: <span class="o">{</span>modality: mode1<span class="o">}</span>
        <span class="p">|</span>
        <span class="p">|</span>- child document: <span class="o">{</span>modality: mode2<span class="o">}</span>
Output:
document: <span class="o">(</span>embedding: multimodal encoding<span class="o">)</span>
        <span class="p">|</span>- child document: <span class="o">{</span>modality: mode1<span class="o">}</span>
        <span class="p">|</span>
        <span class="p">|</span>- child document: <span class="o">{</span>modality: mode2<span class="o">}</span>
</pre></div>
</div>
<p>In the code snippet below, you should be able to see the logic of how we implemented the Driver.
In <code class="xref py py-meth docutils literal notranslate"><span class="pre">_apply_all()</span></code>,
We firstly convert each Document in the <cite>DocumentSet</cite> into a <cite>MultimediaDocument</cite>.
For each instance of the <cite>MultimediaDocument</cite>,
we check if the instance has <code class="xref py py-meth docutils literal notranslate"><span class="pre">modality_content_map()</span></code> (a Python <cite>dict</cite>, where the key is the name of the modality, while value is the content of the modality).
If so, we consider it has a valid <cite>MultimediaDocument</cite>,
and we save the value of the specific Modality into <cite>content_by_modality</cite>.
The result will be fed into <code class="xref py py-meth docutils literal notranslate"><span class="pre">exec_fn()</span></code> as the input (the bound method of the Executor).</p>
<p>Since the class <cite>MultiModalDriver</cite> is based on <cite>BaseEncodeDriver</cite>,
the <code class="xref py py-meth docutils literal notranslate"><span class="pre">exec_fn()</span></code> will be bind to the <code class="xref py py-meth docutils literal notranslate"><span class="pre">encode()</span></code> method,
to encode data from different modalities into embeddings.
Lastly, we assign the <cite>embeddings</cite> property of each Document as the encoded vector representation.
The task of the Driver is now finished.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MultiModalDriver</span><span class="p">(</span><span class="n">FlatRecursiveMixin</span><span class="p">,</span> <span class="n">BaseEncodeDriver</span><span class="p">):</span>
<span class="sd">&quot;&quot;&quot;Extract multimodal embeddings from different modalities.&quot;&quot;&quot;</span>

    <span class="o">...</span>

    <span class="k">def</span> <span class="nf">_apply_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="s1">&#39;DocumentSet&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Apply the driver to each of the Documents in docs.&quot;&quot;&quot;</span>
        <span class="n">content_by_modality</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span>
            <span class="nb">list</span>
        <span class="p">)</span>

        <span class="n">valid_docs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">docs</span><span class="p">:</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="n">MultimodalDocument</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">doc</span><span class="o">.</span><span class="n">modality_content_map</span><span class="p">:</span>
                <span class="n">valid_docs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">modality</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">positional_modality</span><span class="p">:</span>
                    <span class="n">content_by_modality</span><span class="p">[</span><span class="n">modality</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">doc</span><span class="p">[</span><span class="n">modality</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">valid_docs</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">modality</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">positional_modality</span><span class="p">:</span>
                <span class="n">content_by_modality</span><span class="p">[</span><span class="n">modality</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">content_by_modality</span><span class="p">[</span><span class="n">modality</span><span class="p">])</span>

            <span class="n">input_args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_executor_input_arguments</span><span class="p">(</span><span class="n">content_by_modality</span><span class="p">)</span>
            <span class="n">embeds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exec_fn</span><span class="p">(</span><span class="o">*</span><span class="n">input_args</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">doc</span><span class="p">,</span> <span class="n">embedding</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">valid_docs</span><span class="p">,</span> <span class="n">embeds</span><span class="p">):</span>
                <span class="n">doc</span><span class="o">.</span><span class="n">embedding</span> <span class="o">=</span> <span class="n">embedding</span>
</pre></div>
</div>
</div>
<div class="section" id="what-s-next">
<h2><a class="toc-backref" href="#id8">What’s next</a><a class="headerlink" href="#what-s-next" title="Permalink to this headline">¶</a></h2>
<p>Thanks for your time and effort while reading this guide!</p>
<p>Please check out <a class="reference external" href="https://github.com/jina-ai/jina/tree/master/jina/drivers">Jina Core</a> to explore the source code of built-in <cite>Drivers</cite>.
If you still have questions, feel free to <a class="reference external" href="https://github.com/jina-ai/jina/issues">submit an issue</a> or post a message in our <a class="reference external" href="https://docs.jina.ai/chapters/CONTRIBUTING.html#join-us-on-slack">community slack channel</a> .</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        
        <a href="../../flow/" class="btn btn-neutral float-right" title="Composing a Search Workflow with the Flow API"
           accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
        
        
        <a href="../../peas-and-pods/" class="btn btn-neutral float-left" title="Peas and Pods"
           accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
        
    </div>
    

    <hr/>

    <div role="contentinfo">
        <nav class="devsite-footer-linkboxes nocontent" aria-label="Footer links">

            <ul class="devsite-footer-linkboxes-list">

                <li class="devsite-footer-linkbox ">
                    <h3 class="devsite-footer-linkbox-heading no-link">Stay connected</h3>
                    <ul class="devsite-footer-linkbox-list">

                        <li class="devsite-footer-linkbox-item">

                            <a href="https://github.com/jina-ai/jina" class="devsite-footer-linkbox-link gc-analytics-event"
                               data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">

                                <i class="fab fa-github"></i> GitHub

                            </a>

                        </li>

                        <li class="devsite-footer-linkbox-item">

                            <a href="https://www.linkedin.com/company/jinaai/" class="devsite-footer-linkbox-link gc-analytics-event"
                               data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">

                                <i class="fab fa-linkedin"></i> LinkedIn

                            </a>

                        </li>



                        <li class="devsite-footer-linkbox-item">

                            <a href="https://twitter.com/JinaAI_" class="devsite-footer-linkbox-link gc-analytics-event"
                               data-category="Site-Wide Custom Events" data-label="Footer Link (index 3)">

                                <i class="fab fa-twitter"></i> Twitter

                            </a>

                        </li>

                        <li class="devsite-footer-linkbox-item">

                            <a href="https://www.youtube.com/c/JinaAI" class="devsite-footer-linkbox-link gc-analytics-event"
                               data-category="Site-Wide Custom Events" data-label="Footer Link (index 4)">

                                <i class="fab fa-youtube"></i> YouTube

                            </a>

                        </li>

                    </ul>
                </li>

                <li class="devsite-footer-linkbox ">
                    <h3 class="devsite-footer-linkbox-heading no-link">Support</h3>
                    <ul class="devsite-footer-linkbox-list">
                        <li class="devsite-footer-linkbox-item">

                            <a href="https://slack.jina.ai"
                               class="devsite-footer-linkbox-link gc-analytics-event"
                               data-category="Site-Wide Custom Events" data-label="Footer Link (index 3)">

                                <i class="fab fa-slack"></i> Slack community

                            </a>

                        </li>

                        <li class="devsite-footer-linkbox-item">

                            <a href="https://github.com/jina-ai/jina/issues"
                               class="devsite-footer-linkbox-link gc-analytics-event"
                               data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">

                                Issue tracker

                            </a>

                        </li>

                        <li class="devsite-footer-linkbox-item">

                            <a href="https://github.com/jina-ai/jina/blob/master/CHANGELOG.md"
                               class="devsite-footer-linkbox-link gc-analytics-event"
                               data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">

                                Release notes

                            </a>

                        </li>



                        <li class="devsite-footer-linkbox-item">

                            <a href="https://career.jina.ai"
                               class="devsite-footer-linkbox-link gc-analytics-event"
                               data-category="Site-Wide Custom Events" data-label="Footer Link (index 4)">

                                Career@Jina AI

                            </a>

                        </li>


                    </ul>
                </li>

            </ul>

        </nav>
        <p>
            
            &copy; Copyright Jina AI Limited. All rights reserved.
            <span class="lastupdated">
        Last updated on Jun 10, 2021.
      </span>

        </p>
    </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });

      function showhide_navbar() {
      var x = document.getElementsByClassName("wy-nav-side")[0];
      var y = document.getElementsByClassName("wy-nav-content-wrap")[0];
      var z = document.getElementById("showhide-navbar-btn");
      if (x.style.display === "none") {
        x.style.display = "block";
        y.style.marginLeft = "300px";
        z.style.left = "300px";
      } else {
        x.style.display = "none";
        y.style.marginLeft = "0";
        z.style.left = "0px";
      }
    }

  </script>

  <!-- Search box becomes active when you press the slash(/) key anywhere on the page-->
  <script>
    const body = document.querySelector('body');
    const searchBox = document.querySelector('form').querySelector('input[type="text"]');

    body.addEventListener('keyup', event => {
      event.preventDefault()
      if (event.key === '/') {
        searchBox.focus();
      }
    });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-164627626-3', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>