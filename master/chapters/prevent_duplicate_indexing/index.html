

<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="X-UA-Compatible" content="IE=edge">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@JinaAI_">
<meta name="twitter:creator" content="@JinaAI_">
<meta name="description"
      content="Jina is the cloud-native neural search solution powered by the state-of-the-art AI and deep learning">
<meta property="og:title" content="Jina Documentation">
<meta property="og:description"
      content="Jina is the cloud-native neural search solution powered by the state-of-the-art AI and deep learning">
<meta property="og:url" content="https://opensource.jina.ai">
<meta property="og:image" content="../../_static/banner.png">
<meta property="og:type" content="website">
<link rel="icon" href="../../_static/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  
  <title>Prevent Indexing Duplicates &mdash; Jina 1.0.5-master documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/main.css" type="text/css" />


  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Using Flow API to Compose Your Jina Workflow" href="../flow/index.html" />
    <link rel="prev" title="Logging configuration in jina" href="../logging/index.html" /> 
</head>

<body class="wy-body-for-nav">
  <div id="showhide-navbar-btn" onclick="showhide_navbar();"></div>

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="https://docs.jina.ai">
          

          
            
            <img src="../../_static/jina-prod-logo.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            

          <div class="dropdown version">
            <button class="dropbtn version">1.0.5-master</button>
            <div class="dropdown-content">
              
              <a class="dropdown-item" href="/master">master</a>
              
              <a class="dropdown-item" href="/v1.0.1">1.0.1</a>
              
              <a class="dropdown-item" href="/v1.0.0">1.0.0</a>
              
              <a class="dropdown-item" href="/v0.9.8">0.9.8</a>
              
              <a class="dropdown-item" href="/v0.9.7">0.9.7</a>
              
              <a class="dropdown-item" href="/v0.9.6">0.9.6</a>
              
              <a class="dropdown-item" href="/v0.9.5">0.9.5</a>
              
              <a class="dropdown-item" href="/v0.9.4">0.9.4</a>
              
              <a class="dropdown-item" href="/v0.9.34">0.9.34</a>
              
              <a class="dropdown-item" href="/v0.9.33">0.9.33</a>
              
              <a class="dropdown-item" href="/v0.9.3">0.9.3</a>
              
              <a class="dropdown-item" href="/v0.9.28">0.9.28</a>
              
              <a class="dropdown-item" href="/v0.9.23">0.9.23</a>
              
              <a class="dropdown-item" href="/v0.9.22">0.9.22</a>
              
              <a class="dropdown-item" href="/v0.9.21">0.9.21</a>
              
              <a class="dropdown-item" href="/v0.9.20">0.9.20</a>
              
              <a class="dropdown-item" href="/v0.9.19">0.9.19</a>
              
              <a class="dropdown-item" href="/v0.9.18">0.9.18</a>
              
              <a class="dropdown-item" href="/v0.9.17">0.9.17</a>
              
              <a class="dropdown-item" href="/v0.9.16">0.9.16</a>
              
              <a class="dropdown-item" href="/v0.9.15">0.9.15</a>
              
              <a class="dropdown-item" href="/v0.9.14">0.9.14</a>
              
              <a class="dropdown-item" href="/v0.9.13">0.9.13</a>
              
              <a class="dropdown-item" href="/v0.9.12">0.9.12</a>
              
              <a class="dropdown-item" href="/v0.9.11">0.9.11</a>
              
              <a class="dropdown-item" href="/v0.9.10">0.9.10</a>
              
              <a class="dropdown-item" href="/v0.9.9">0.9.9</a>
              
              <a class="dropdown-item" href="/v0.9.8">0.9.8</a>
              
              <a class="dropdown-item" href="/v0.9.7">0.9.7</a>
              
              <a class="dropdown-item" href="/v0.9.6">0.9.6</a>
              
              <a class="dropdown-item" href="/v0.9.5">0.9.5</a>
              
              <a class="dropdown-item" href="/v0.9.3">0.9.3</a>
              
              <a class="dropdown-item" href="/v0.9.2">0.9.2</a>
              
              <a class="dropdown-item" href="/v0.9.1">0.9.1</a>
              
              <a class="dropdown-item" href="/v0.9.0">0.9.0</a>
              
              <a class="dropdown-item" href="/v0.8.22">0.8.22</a>
              
              <a class="dropdown-item" href="/v0.8.21">0.8.21</a>
              
            </div>
          </div>
            
          


          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Jina Core</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../core/introduction/index.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../core/guides/index.html">Developer Guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../install/index.html">Installing Jina Core</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cross-multi-modality/index.html">Multi-modal and Cross-modal Search in Jina</a></li>
<li class="toctree-l2"><a class="reference internal" href="../crud/index.html">CRUD Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging/index.html">Logging configuration in jina</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Prevent Indexing Duplicates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../flow/index.html">Using Flow API to Compose Your Jina Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../flow/pattern.html">Common Design Patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../io/index.html">Input and Output Functions in Jina</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traversal/index.html">Understand Jina Recursive Document Representation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extend/driver.html">Guideline When Adding New Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extend/executor.html">Guideline When Adding New Executor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extend/mwu.html">A Minimum Working Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../remote/index.html">Using Jina Pod Remotely</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parallel/index.html">Parallelization in Jina</a></li>
<li class="toctree-l2"><a class="reference internal" href="../primitive_data_type/index.html">A guide on Jina Primitive Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../traversal/index.html">Understand Jina Recursive Document Representation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simple_exec.html">Built-in Simple Executors and Reserved <code class="docutils literal notranslate"><span class="pre">uses</span></code> in Jina</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/exit.html">Gracefully Exit Jina</a></li>
<li class="toctree-l2"><a class="reference internal" href="../envs.html">OS Environment Variables Used in Jina</a></li>
<li class="toctree-l2"><a class="reference internal" href="../project-guide/project-guide.html">Project set up guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optimization/index.html">Flow Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../request_size/request_size.html">Understanding the Request Size parameter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../evaluation/index.html">A Guide to Jina Flow Evaluation Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incremental_indexing/index.html">Incremental Indexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stress/index.html">Jina Cloud Benchmark &amp; Deployment</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../core/api_references/index.html">API References</a></li>
</ul>
<p class="caption"><span class="caption-text">Jina Dashboard</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dashboard/introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dashboard/guides/index.html">Developer Guides</a></li>
</ul>
<p class="caption"><span class="caption-text">Jina Hub</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hub/introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hub/guides/index.html">Developer Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hub/api_references/index.html">API References</a></li>
</ul>
<p class="caption"><span class="caption-text">Jina Box</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../box/introduction/index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../box/guides/index.html">Developer Guides</a></li>
</ul>
<p class="caption"><span class="caption-text">Glossary</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../glossary/glossary.html">Glossary</a></li>
</ul>
<p class="caption"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING.html">Contributing to Jina</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING.html#join-us-on-slack">Join Us on Slack!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../RELEASE.html">Release &amp; Version Identifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOG.html">Change Logs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../jep/index.html">Jina Enhancement Proposals (JEP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/dev.html">FAQ for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/user.html">FAQ for End-Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docstring/docstring.html">Docstring Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Indices and Tables</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../all_exec.html">List of 57 Executors in Jina</a></li>
<li class="toctree-l1"><a class="reference internal" href="../all_driver.html">List of 73 Drivers in Jina</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Jina</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation" class="nav-bar-header">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../core/guides/index.html">Developer Guides</a> &raquo;</li>
        
      <li>Prevent Indexing Duplicates</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  
<div role="search" class="nav-bar-search">
  <form id="rtd-search-form" class="wy-form doc-searchbox" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs (Press / to focus)" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

</div>
<hr/>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="prevent-indexing-duplicates">
<h1>Prevent Indexing Duplicates<a class="headerlink" href="#prevent-indexing-duplicates" title="Permalink to this headline">¶</a></h1>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>When indexing documents, it is common to have duplicate documents received by the search system. This document will show you how to prevent indexing duplicates in Jina.</p>
</div>
<div class="section" id="feature-description">
<h2>Feature Description<a class="headerlink" href="#feature-description" title="Permalink to this headline">¶</a></h2>
<p>One can either remove the duplicates before sending the duplicates to Jina or leave it to Jina for handling the duplicates.</p>
</div>
<div class="section" id="before-you-start">
<h2>Before you start<a class="headerlink" href="#before-you-start" title="Permalink to this headline">¶</a></h2>
<p>Make sure you are familiar with <a class="reference external" href="https://docs.jina.ai/chapters/yaml/executor.html">Executor YAML Sytax</a>.</p>
</div>
<div class="section" id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="when-shards-1">
<h3>When <code class="docutils literal notranslate"><span class="pre">shards</span> <span class="pre">==</span> <span class="pre">1</span></code><a class="headerlink" href="#when-shards-1" title="Permalink to this headline">¶</a></h3>
<p>If you are not using multiple shards, the built-in executor <cite>UniqueVectorIndexer</cite> and <cite>UniquePbIndexer</cite> can be used directly for keeping the unique indexed Documents. In the following codes, there are four Documents (including two unique ones) feeded to the Flow and only two unique ones are indexed.</p>
<dl class="std confval">
<dt id="confval-demo_prevent_duplicate.py">
<code class="sig-name descname"><span class="pre">demo_prevent_duplicate.py</span></code><a class="headerlink" href="#confval-demo_prevent_duplicate.py" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Flow</span><span class="p">,</span> <span class="n">Document</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">docs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Document</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;doc</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">embedding</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">assert_only_two_docs_indexed</span><span class="p">(</span><span class="n">rsp</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">rsp</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">docs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">Flow</span><span class="p">()</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">uses</span><span class="o">=</span><span class="s1">&#39;unique_vec_idx.yml&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">docs</span> <span class="o">+</span> <span class="n">docs</span><span class="p">,</span> <span class="n">on_done</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">assert_only_two_docs_indexed</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="std confval">
<dt id="confval-unique_vec_idx.yml">
<code class="sig-name descname"><span class="pre">unique_vec_idx.yml</span></code><a class="headerlink" href="#confval-unique_vec_idx.yml" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="kt">!UniqueVectorIndexer</span>
<span class="nt">components</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="kt">!DocCache</span>
    <span class="nt">metas</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">doc_cache</span>
  <span class="p p-Indicator">-</span> <span class="kt">!NumpyIndexer</span>
    <span class="nt">metas</span><span class="p">:</span>
      <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">numpy_indexer</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="id1">
<h3>When <code class="docutils literal notranslate"><span class="pre">shards</span> <span class="pre">&gt;</span> <span class="pre">1</span></code><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>When <code class="docutils literal notranslate"><span class="pre">shards</span> <span class="pre">&gt;</span> <span class="pre">1</span></code>, one needs to add <code class="docutils literal notranslate"><span class="pre">_unique</span></code> for the <code class="docutils literal notranslate"><span class="pre">uses_before</span></code> option. The reason is that different Peas might be running of different machines and therefore we need to check whether Document exists or not before sending the Document to one for the shards. In the following example, there are 40 Documents (including 20 unique ones) indexed by the Flow. We use <cite>on_done</cite> argument to check how many Documents are indexed. We use two shards in this example.</p>
<dl class="std confval">
<dt id="confval-demo_prevent_duplicate_multishards.py">
<code class="sig-name descname"><span class="pre">demo_prevent_duplicate_multishards.py</span></code><a class="headerlink" href="#confval-demo_prevent_duplicate_multishards.py" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Flow</span><span class="p">,</span> <span class="n">Document</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">docs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Document</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;doc</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">embedding</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">assert_only_twenty_docs_indexed</span><span class="p">(</span><span class="n">rsp</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">rsp</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">docs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">20</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">Flow</span><span class="p">()</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
    <span class="n">uses</span><span class="o">=</span><span class="s1">&#39;NumpyIndexer&#39;</span><span class="p">,</span> <span class="n">uses_before</span><span class="o">=</span><span class="s1">&#39;_unique&#39;</span><span class="p">,</span> <span class="n">shards</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="k">with</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">docs</span> <span class="o">+</span> <span class="n">docs</span><span class="p">,</span> <span class="n">on_done</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">assert_only_twenty_docs_indexed</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<p>Under the hood, the configuration yaml file, <code class="docutils literal notranslate"><span class="pre">jina/resources/executors._unique.yml</span></code>, is used. The yaml file is defined as below</p>
<dl class="std confval">
<dt id="confval-jina-resources-executors._unique.yml">
<span id="confval-jina/resources/executors._unique.yml"></span><code class="sig-name descname"><span class="pre">jina/resources/executors._unique.yml</span></code><a class="headerlink" href="#confval-jina-resources-executors._unique.yml" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="kt">!DocCache</span>
<span class="nt">with</span><span class="p">:</span>
  <span class="nt">index_path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">unique.tmp</span>
<span class="nt">metas</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">unique</span>
<span class="nt">requests</span><span class="p">:</span>
  <span class="nt">on</span><span class="p">:</span>
    <span class="p p-Indicator">[</span><span class="nv">SearchRequest</span><span class="p p-Indicator">,</span> <span class="nv">TrainRequest</span><span class="p p-Indicator">,</span> <span class="nv">IndexRequest</span><span class="p p-Indicator">,</span> <span class="nv">DeleteRequest</span><span class="p p-Indicator">,</span> <span class="nv">UpdateRequest</span><span class="p p-Indicator">,</span> <span class="nv">ControlRequest</span><span class="p p-Indicator">]:</span>
      <span class="p p-Indicator">-</span> <span class="kt">!RouteDriver</span> <span class="p p-Indicator">{}</span>
    <span class="nt">IndexRequest</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="kt">!TaggingCacheDriver</span>
        <span class="nt">with</span><span class="p">:</span>
          <span class="nt">tags</span><span class="p">:</span>
            <span class="nt">is_indexed</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
      <span class="p p-Indicator">-</span> <span class="kt">!FilterQL</span>
        <span class="nt">with</span><span class="p">:</span>
          <span class="nt">lookups</span><span class="p">:</span> <span class="p p-Indicator">{</span><span class="nt">tags__is_indexed__neq</span><span class="p">:</span> <span class="nv">true</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
</dd></dl>

<p><a class="reference internal" href="../../api/jina.executors.indexers.cache.html#jina.executors.indexers.cache.DocCache" title="jina.executors.indexers.cache.DocCache"><code class="xref py py-class docutils literal notranslate"><span class="pre">jina.executors.indexers.cache.DocCache</span></code></a> uses document ID to detect the duplicates. The documents with the same ID are considered as the same one. <a class="reference internal" href="../../api/jina.drivers.cache.html#jina.drivers.cache.TaggingCacheDriver" title="jina.drivers.cache.TaggingCacheDriver"><code class="xref py py-class docutils literal notranslate"><span class="pre">jina.drivers.cache.TaggingCacheDriver</span></code></a> keep a set of the indexed keys and check against the cache for a hit. If the document id exists, <a class="reference internal" href="../../api/jina.drivers.cache.html#jina.drivers.cache.TaggingCacheDriver" title="jina.drivers.cache.TaggingCacheDriver"><code class="xref py py-class docutils literal notranslate"><span class="pre">jina.drivers.cache.TaggingCacheDriver</span></code></a> sets the customized keys in the <code class="docutils literal notranslate"><span class="pre">tags</span></code> field to the predefined value. In the above configuration, <code class="docutils literal notranslate"><span class="pre">is_indexed</span></code> in the <code class="docutils literal notranslate"><span class="pre">tags</span></code> field is set to <code class="docutils literal notranslate"><span class="pre">true</span></code> when the document id hit the cached indexed keys. Afterwards, <a class="reference internal" href="../../api/jina.drivers.querylang.filter.html#jina.drivers.querylang.filter.FilterQL" title="jina.drivers.querylang.filter.FilterQL"><code class="xref py py-class docutils literal notranslate"><span class="pre">jina.drivers.querylang.filter.FilterQL</span></code></a> is used to filter out the duplicate documents from the request.</p>
</div>
</div>
<div class="section" id="limitations">
<h2>Limitations<a class="headerlink" href="#limitations" title="Permalink to this headline">¶</a></h2>
<p>Be careful when using <code class="docutils literal notranslate"><span class="pre">_unique</span></code> keyword as a cache executor, it will not set any <code class="docutils literal notranslate"><span class="pre">workspace</span></code> where the data is stored.
By default, it uses the folder where it runs as <code class="docutils literal notranslate"><span class="pre">workspace</span></code>, which may not be where the actual indexers store their data. If you want to store the cache in a specific workspace while keeping the same functionality,</p>
<blockquote>
<div><p>you need to define <code class="docutils literal notranslate"><span class="pre">unique_customized.yml</span></code> as below to set the desired <code class="docutils literal notranslate"><span class="pre">workspace</span></code> under metas.</p>
</div></blockquote>
<dl class="std confval">
<dt id="confval-unique_customized.yml">
<code class="sig-name descname"><span class="pre">unique_customized.yml</span></code><a class="headerlink" href="#confval-unique_customized.yml" title="Permalink to this definition">¶</a></dt>
<dd><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="kt">!DocCache</span>
<span class="nt">with</span><span class="p">:</span>
  <span class="nt">index_path</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cache.tmp</span>
<span class="nt">metas</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cache</span>
  <span class="nt">workspace</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">$WORKSPACE</span>
  <span class="l l-Scalar l-Scalar-Plain">...</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        
        <a href="../flow/index.html" class="btn btn-neutral float-right" title="Using Flow API to Compose Your Jina Workflow"
           accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
        
        
        <a href="../logging/index.html" class="btn btn-neutral float-left" title="Logging configuration in jina"
           accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
        
    </div>
    

    <hr/>

    <div role="contentinfo">
        <nav class="devsite-footer-linkboxes nocontent" aria-label="Footer links">

            <ul class="devsite-footer-linkboxes-list">

                <li class="devsite-footer-linkbox ">
                    <h3 class="devsite-footer-linkbox-heading no-link">Stay connected</h3>
                    <ul class="devsite-footer-linkbox-list">

                        <li class="devsite-footer-linkbox-item">

                            <a href="https://github.com/jina-ai/jina" class="devsite-footer-linkbox-link gc-analytics-event"
                               data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">

                                <i class="fab fa-github"></i> GitHub

                            </a>

                        </li>

                        <li class="devsite-footer-linkbox-item">

                            <a href="https://www.linkedin.com/company/jinaai/" class="devsite-footer-linkbox-link gc-analytics-event"
                               data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">

                                <i class="fab fa-linkedin"></i> LinkedIn

                            </a>

                        </li>



                        <li class="devsite-footer-linkbox-item">

                            <a href="https://twitter.com/JinaAI_" class="devsite-footer-linkbox-link gc-analytics-event"
                               data-category="Site-Wide Custom Events" data-label="Footer Link (index 3)">

                                <i class="fab fa-twitter"></i> Twitter

                            </a>

                        </li>

                        <li class="devsite-footer-linkbox-item">

                            <a href="https://www.youtube.com/c/JinaAI" class="devsite-footer-linkbox-link gc-analytics-event"
                               data-category="Site-Wide Custom Events" data-label="Footer Link (index 4)">

                                <i class="fab fa-youtube"></i> YouTube

                            </a>

                        </li>

                    </ul>
                </li>

                <li class="devsite-footer-linkbox ">
                    <h3 class="devsite-footer-linkbox-heading no-link">Support</h3>
                    <ul class="devsite-footer-linkbox-list">
                        <li class="devsite-footer-linkbox-item">

                            <a href="https://slack.jina.ai"
                               class="devsite-footer-linkbox-link gc-analytics-event"
                               data-category="Site-Wide Custom Events" data-label="Footer Link (index 3)">

                                <i class="fab fa-slack"></i> Slack community

                            </a>

                        </li>

                        <li class="devsite-footer-linkbox-item">

                            <a href="https://github.com/jina-ai/jina/issues"
                               class="devsite-footer-linkbox-link gc-analytics-event"
                               data-category="Site-Wide Custom Events" data-label="Footer Link (index 1)">

                                Issue tracker

                            </a>

                        </li>

                        <li class="devsite-footer-linkbox-item">

                            <a href="https://github.com/jina-ai/jina/blob/master/CHANGELOG.md"
                               class="devsite-footer-linkbox-link gc-analytics-event"
                               data-category="Site-Wide Custom Events" data-label="Footer Link (index 2)">

                                Release notes

                            </a>

                        </li>



                        <li class="devsite-footer-linkbox-item">

                            <a href="https://career.jina.ai"
                               class="devsite-footer-linkbox-link gc-analytics-event"
                               data-category="Site-Wide Custom Events" data-label="Footer Link (index 4)">

                                Career@Jina AI

                            </a>

                        </li>


                    </ul>
                </li>

            </ul>

        </nav>
        <p>
            
            &copy; Copyright Jina AI Limited. All rights reserved.
            <span class="lastupdated">
        Last updated on Feb 22, 2021.
      </span>

        </p>
    </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });

      function showhide_navbar() {
      var x = document.getElementsByClassName("wy-nav-side")[0];
      var y = document.getElementsByClassName("wy-nav-content-wrap")[0];
      var z = document.getElementById("showhide-navbar-btn");
      if (x.style.display === "none") {
        x.style.display = "block";
        y.style.marginLeft = "300px";
        z.style.left = "300px";
      } else {
        x.style.display = "none";
        y.style.marginLeft = "0";
        z.style.left = "0px";
      }
    }

  </script>

  <!-- Search box becomes active when you press the slash(/) key anywhere on the page-->
  <script>
    const body = document.querySelector('body');
    const searchBox = document.querySelector('form').querySelector('input[type="text"]');

    body.addEventListener('keyup', event => {
      event.preventDefault()
      if (event.key === '/') {
        searchBox.focus();
      }
    });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-164627626-3', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>